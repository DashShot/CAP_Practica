#include<iostream>

///////////////////////////// CASO 1 ///////////////////////////////////////////////////////////////////////////////////////////////
#define nLines 9			//N�mero de filas de los textos cifrados
#define nCharsPerLine 33	//N�mero de caracteres en cada fila de los textos cifrados
#define nRotors 2			//N�mero de rotores de enigma para cifrar y descifrar

int ciphered[nLines][nCharsPerLine] = { //[9][33] - 2 rotores
	{65,63,59,89,50,117,131,56,142,132,131,64,153,133,154,139,146,145,160,80,161,162,86,172,162,161,94,183,163,176,178,187,120},
	{57,65,57,87,48,115,129,54,140,130,129,62,134,139,150,139,72,158,148,143,164,82,150,171,170,168,175,94,161,169,165,175,182},
	{53,57,53,125,128,46,132,122,121,54,123,137,136,130,76,66,152,142,141,74,152,151,151,154,168,86,172,162,157,178,96,164,182},
	{61,70,60,122,129,124,138,57,143,133,132,65,135,134,158,151,87,77,163,153,152,85,159,168,173,171,95,181,171,166,187,105,194},
	{55,58,54,108,120,116,132,51,137,127,126,59,144,139,134,136,149,140,155,158,89,79,165,155,154,87,172,163,166,164,173,167,101},
	{61,58,56,129,119,114,135,53,126,142,124,143,131,148,67,153,143,142,75,159,148,146,159,162,170,89,170,163,95,174,168,179,117},
	{57,65,57,87,48,130,128,123,124,129,129,62,141,155,68,146,145,144,145,78,145,160,152,86,160,169,170,173,178,98,184,181,104},
	{67,64,60,133,123,122,55,103,132,132,135,149,8252,152,71,128,140,161,146,153,95,85,157,168,173,93,179,169,172,184,103,183,180},
	{57,56,54,114,117,131,49,116,131,123,57,124,137,139,65,151,141,140,73,153,150,150,153,167,168,87,173,170,93,162,176,176,170},
};
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////// CASO 2 ///////////////////////////////////////////////////////////////////////////////////////////////
//#define nLines 8			//N�mero de filas de los textos cifrados
//#define nCharsPerLine 93	//N�mero de caracteres en cada fila de los textos cifrados
//#define nRotors 5			//N�mero de rotores de enigma para cifrar y descifrar
//int ciphered[nLines][nCharsPerLine] = { //[8][93] - 5 rotores
//	{75,76,88,85,98,92,134,158,174,175,169,176,187,197,195,129,218,211,213,149,230,228,248,253,243,261,267,189,259,282,204,281,283,219,296,294,302,239,314,328,339,337,332,269,358,351,353,366,306,299,337,375,392,388,406,329,379,404,426,432,426,359,446,448,457,448,384,454,472,467,404,486,493,505,493,497,434,504,510,528,539,543,464,553,546,548,484,556,559,565,577,587,526},
//	{72,82,87,90,97,93,161,169,174,175,178,188,186,120,195,209,217,140,228,229,232,229,249,242,248,258,256,190,264,276,288,279,227,220,308,309,312,309,329,322,328,338,336,270,359,359,285,359,373,376,378,381,387,404,394,408,335,412,418,427,369,360,405,439,375,450,464,475,473,468,405,488,494,504,497,503,513,511,472,450,522,536,544,554,547,553,563,561,495,573,583,510,599},
//	{73,80,90,91,100,94,158,160,96,169,188,176,203,190,208,214,148,141,203,230,238,236,8351,254,176,267,259,267,265,214,290,276,299,305,299,309,307,241,314,333,329,339,341,271,349,359,286,375,368,370,306,398,389,399,395,331,418,406,413,426,368,361,449,456,449,465,469,391,468,466,484,482,416,494,504,431,520,513,515,451,523,537,545,554,545,565,498,491,562,580,585,586,599},
//	{71,78,77,84,94,89,150,172,160,178,190,193,183,185,203,195,145,181,206,228,234,228,161,233,243,245,248,261,260,264,201,290,283,285,221,310,304,320,317,315,334,256,340,336,271,360,353,355,291,382,380,382,396,393,390,409,331,402,430,346,408,435,443,441,8556,459,381,452,460,464,401,489,484,484,490,453,431,515,519,515,451,543,526,549,471,541,481,552,570,575,576,506,590},
//	{84,90,87,100,97,98,160,95,180,184,179,199,202,214,130,201,229,145,201,227,229,241,246,244,269,197,190,279,272,274,210,294,304,297,299,317,240,328,329,332,329,265,353,354,362,369,290,374,370,305,387,384,388,398,397,400,416,345,416,434,439,440,370,447,449,385,457,474,485,481,478,415,503,492,495,517,507,514,526,544,460,550,548,543,549,567,573,579,565,583,578,515,585},
//	{90,95,96,103,104,103,171,173,183,179,115,199,195,144,187,212,214,150,239,225,241,246,175,246,264,269,270,267,270,293,284,220,304,300,305,309,327,319,323,260,342,349,357,349,285,369,365,300,389,382,384,320,408,395,412,409,372,350,432,445,432,442,375,450,458,457,479,473,484,488,415,485,503,498,435,520,524,519,539,542,554,482,475,545,485,560,560,573,587,510,580,597,604},
//	{80,80,87,96,97,95,172,170,181,102,186,182,117,194,200,215,221,221,229,241,169,162,233,251,256,257,270,192,276,280,207,289,286,290,300,299,310,320,316,252,322,340,335,272,357,354,360,368,376,385,386,392,389,411,327,397,415,410,347,430,422,446,452,454,442,458,387,475,464,475,476,490,484,491,439,432,502,442,515,537,540,546,556,472,556,558,555,492,581,581,584,581,517},
//	{89,95,96,106,108,104,175,179,106,176,192,188,198,200,213,230,158,151,221,239,166,240,254,265,259,273,265,201,289,283,285,297,296,231,315,311,246,317,335,340,341,354,276,354,364,291,366,380,388,380,389,392,404,331,412,406,424,422,441,426,437,440,459,395,399,404,409,414,419,424,429,434,439,444,449,454,459,464,469,474,479,484,489,494,499,504,509,514,519,524,529,534,539},
//};
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////// CASO 3 ///////////////////////////////////////////////////////////////////////////////////////////////
//#define nLines 23			//N�mero de filas de los textos cifrados
//#define nCharsPerLine 138	//N�mero de caracteres en cada fila de los textos cifrados
//#define nRotors 5			//N�mero de rotores de enigma para cifrar y descifrar
//int ciphered[nLines][nCharsPerLine] = { //[23][138] - 5 rotores
//	{73,76,79,84,86,88,115,161,169,180,168,105,145,194,197,205,215,219,213,223,221,155,233,248,170,253,259,269,262,268,278,276,210,281,305,309,230,318,324,324,332,328,338,336,270,340,358,353,290,360,367,372,379,398,403,398,408,406,340,413,415,439,425,373,446,448,455,454,390,484,479,490,492,415,493,502,495,506,509,528,462,455,546,538,538,544,559,568,502,495,568,584,577,600,597,594,608,619,623,557,550,624,644,632,579,575,645,663,658,595,680,687,689,686,702,690,707,718,652,645,729,741,729,747,670,759,752,754,690,768,778,789,779,797,798,794,814,747},
//	{77,81,91,94,103,96,88,166,176,186,192,182,183,191,128,212,208,143,237,232,243,245,168,240,257,260,268,278,282,272,290,213,290,288,310,301,238,311,330,326,344,332,268,352,360,283,365,372,364,376,384,382,401,323,401,411,422,412,430,431,423,439,368,456,462,462,470,458,469,472,422,413,475,502,513,433,503,519,524,453,535,536,539,545,562,483,554,562,498,588,591,586,596,594,528,572,617,622,619,629,627,563,604,655,651,669,657,605,598,642,687,692,689,699,697,633,686,715,727,737,737,746,680,673,725,761,757,729,780,776,794,782,730,723,779,798,815,826},
//	{70,78,85,87,90,90,167,165,163,97,169,183,191,202,190,139,132,210,177,223,231,242,230,167,242,256,264,187,258,262,269,282,285,295,293,227,317,317,242,336,331,342,344,267,345,354,362,366,374,381,367,385,396,317,390,392,416,402,354,347,436,429,435,450,372,450,465,387,459,462,478,483,481,485,422,510,516,516,524,520,530,528,462,532,550,545,482,552,559,564,571,590,595,590,600,598,532,605,607,631,617,565,639,636,650,661,655,666,670,666,670,607,685,695,622,711,704,706,642,715,721,727,735,745,745,761,755,766,770,706,716,707,767,786,722,792,808,813},
//	{68,79,77,82,92,88,80,170,173,164,100,144,123,160,185,198,206,135,219,227,150,200,233,232,252,254,263,264,260,279,200,284,295,299,296,304,309,310,252,245,334,327,329,348,339,275,345,367,359,295,367,370,386,391,389,393,330,415,422,424,421,437,425,442,453,383,457,454,468,479,473,484,488,484,488,425,503,513,440,529,522,524,460,533,539,545,553,563,563,579,573,584,588,524,534,525,565,600,618,545,637,624,560,630,637,642,649,668,673,595,684,677,689,698,689,625,695,715,720,721,723,722,725,749,743,754,758,768,690,782,773,789,782,794,805,809,730,808},
//	{80,80,87,89,92,93,163,174,164,182,183,179,199,120,192,209,213,218,214,217,239,233,244,248,206,180,237,262,264,200,270,288,298,307,294,312,235,313,328,250,333,339,277,270,359,352,350,374,295,373,388,310,402,392,414,330,422,409,345,433,420,433,433,370,454,466,454,472,395,484,477,479,415,493,503,514,504,522,523,519,539,468,542,539,553,564,558,569,573,569,573,510,588,598,525,614,607,609,545,618,624,630,638,648,648,664,658,669,673,609,619,610,649,689,695,709,717,709,645,737,724,660,733,743,761,749,685,758,764,769,785,710,788,798,809,809,735,812},
//	{68,70,80,79,83,85,156,169,87,179,166,102,174,177,195,122,212,215,206,142,231,224,226,162,234,248,256,267,255,192,267,281,289,212,296,307,309,232,303,327,330,325,335,331,350,355,289,282,363,361,381,8487,390,312,392,400,406,419,337,412,429,431,434,362,454,444,446,464,456,392,464,478,486,497,485,422,494,511,514,522,532,536,530,540,538,472,548,561,571,492,570,586,590,512,595,587,604,601,537,612,629,631,634,593,567,613,655,582,671,664,666,602,687,677,700,706,627,716,716,642,729,721,737,744,736,755,746,760,771,692,781,774,776,712,790,800,811,801},
//	{67,75,82,80,88,87,161,162,158,178,99,177,187,114,203,196,198,134,209,220,228,241,159,231,241,239,261,268,272,206,199,284,278,293,299,300,298,234,326,323,334,330,327,264,337,356,344,371,289,359,299,371,385,393,404,392,329,418,418,344,432,443,436,430,448,450,452,474,458,394,466,480,488,499,487,436,429,518,511,529,532,454,494,540,548,559,547,484,524,573,576,584,594,598,592,602,600,548,539,596,621,623,641,633,569,639,661,653,589,678,671,686,678,683,619,711,694,723,722,644,721,733,746,664,753,753,679,769,772,763,699,788,781,783,719,791,805,813},
//	{70,73,76,84,89,87,164,152,103,94,151,176,178,203,119,189,211,203,139,185,214,219,210,172,210,252,249,266,254,277,283,286,294,281,303,309,311,303,239,309,332,254,324,264,320,343,361,370,362,361,368,313,321,314,367,389,394,385,347,392,425,419,443,434,448,456,456,384,454,477,399,469,409,465,488,506,515,507,506,513,458,466,459,515,534,539,530,492,540,573,569,588,596,579,601,593,529,599,622,544,614,554,610,633,651,660,652,651,658,603,613,604,664,686,688,702,629,723,718,729,649,726,728,729,751,674,758,766,689,777,764,793,709,779,802,724,794,734},
//	{62,66,72,74,82,81,124,147,165,174,166,165,172,120,113,200,192,205,202,215,209,217,235,170,163,252,245,247,183,255,278,281,287,287,290,287,305,228,306,321,243,333,336,331,341,339,273,361,362,365,362,377,381,377,313,387,399,411,402,338,416,426,423,440,428,451,457,460,468,455,477,483,485,477,413,488,502,510,433,510,516,531,453,524,548,551,546,556,552,571,576,512,503,549,591,588,605,593,616,622,625,633,620,642,648,650,642,578,648,671,593,663,603,659,682,700,709,701,700,707,643,656,694,723,728,719,682,704,683,729,777,698,776,791,713,783,723,805},
//	{72,78,86,91,95,92,163,157,163,175,104,193,186,184,208,129,199,215,220,228,221,224,248,238,257,179,270,262,276,283,289,274,290,292,314,298,302,239,311,328,331,339,349,353,347,357,355,289,376,368,387,388,399,401,391,398,417,339,420,422,429,428,364,452,443,461,470,458,476,482,416,409,497,503,503,511,499,510,513,461,454,537,533,553,561,558,566,564,494,583,583,509,598,591,593,529,619,622,613,631,554,643,636,651,653,664,655,661,594,683,676,678,614,692,702,713,703,721,722,718,738,673,664,721,739,754,753,689,739,768,772,782,799,796,724,799,813,821},
//	{72,83,82,89,90,91,83,157,181,163,180,188,189,187,135,128,178,207,211,221,238,235,163,250,242,254,256,257,276,198,275,277,278,304,296,304,322,238,322,326,253,291,340,333,363,357,361,288,348,367,369,308,364,387,405,414,406,405,412,431,361,391,418,419,382,378,470,460,466,465,475,408,486,501,423,493,511,438,484,513,518,509,463,535,552,555,563,553,571,587,517,508,568,590,588,612,533,610,608,628,633,627,641,651,573,650,652,670,662,598,676,691,613,651,700,693,723,717,721,648,733,740,742,754,746,746,752,771,693,782,775,777,713,785,802,805,813,823},
//	{78,78,83,89,94,92,168,162,172,170,104,191,183,202,203,214,216,206,213,232,154,243,243,169,258,251,253,189,239,268,272,282,299,296,238,229,267,317,312,249,299,328,332,342,359,356,284,361,359,382,304,375,399,392,400,413,334,404,344,429,439,425,440,442,457,451,457,467,465,399,474,488,496,504,501,429,513,517,444,533,533,539,464,548,544,479,557,573,508,499,538,594,598,519,608,601,603,621,613,549,627,642,564,652,658,652,660,665,594,682,683,686,683,619,711,708,716,714,644,733,726,724,748,669,752,748,753,757,777,699,788,788,714,785,793,729,802,818},
//	{66,74,72,78,84,84,154,150,86,157,185,101,151,180,184,194,211,208,136,217,219,226,225,161,239,249,259,265,251,267,272,274,284,282,216,289,291,315,301,307,311,334,325,261,331,349,344,281,351,373,363,373,379,395,385,388,410,416,418,410,346,419,425,444,439,442,454,381,455,475,463,415,406,452,494,421,506,507,501,514,524,463,456,550,545,556,476,547,571,580,496,566,584,511,581,601,591,613,620,618,615,629,640,569,632,656,665,654,664,662,596,674,684,681,698,686,709,715,718,726,713,735,741,743,735,671,752,754,761,760,696,784,775,793,802,790,808,814},
//	{69,74,81,84,96,89,93,86,174,180,180,188,176,187,190,138,131,214,210,230,238,235,243,241,180,176,187,186,267,269,287,275,211,300,293,295,313,305,255,246,285,341,345,278,271,365,360,371,291,374,370,375,379,316,405,405,331,404,410,429,424,427,439,366,460,455,466,468,391,478,480,485,488,499,429,491,513,503,513,519,535,525,528,550,556,558,550,486,559,565,584,579,582,594,594,604,602,545,553,546,624,634,644,650,636,652,657,586,660,672,670,673,695,698,694,693,704,720,730,654,724,734,744,750,736,752,757,759,769,767,701,774,776,800,786,792,796,819},
//	{68,72,78,88,86,87,148,93,103,94,151,176,178,114,184,204,194,216,223,221,218,232,243,164,242,257,179,273,268,279,281,287,209,280,304,308,229,318,311,313,249,330,324,342,337,274,285,284,355,379,372,380,377,387,397,395,329,400,408,420,428,432,430,364,453,453,379,467,468,471,468,483,487,483,419,493,505,517,508,458,449,487,536,529,559,553,557,484,544,563,565,504,560,583,601,610,602,601,608,627,557,587,614,615,578,586,579,629,662,661,681,683,692,693,689,708,629,667,729,729,731,723,659,729,751,743,679,753,777,759,776,784,785,783,802,724,808,804},
//	{89,89,97,105,108,103,95,173,189,124,115,168,201,195,219,210,224,232,232,160,230,253,175,245,185,241,264,282,291,283,282,289,233,278,300,305,296,259,281,260,306,354,275,353,368,290,360,300,382,389,383,389,401,330,408,418,345,437,427,433,432,442,375,445,385,474,467,473,487,478,428,500,490,512,519,529,445,530,537,539,551,543,543,549,567,490,563,569,581,583,601,589,607,613,535,612,610,632,623,647,630,652,644,580,650,668,663,600,688,689,685,704,712,695,717,709,645,734,734,739,741,753,687,680,769,762,764,700,790,793,784,802,725,797,800,818,745,835},
//	{69,70,74,83,90,86,161,152,88,177,170,172,185,113,186,196,210,202,205,227,224,242,172,163,209,251,178,263,264,258,271,281,220,213,302,295,301,316,238,322,326,322,258,334,341,359,347,366,288,382,377,388,308,378,318,393,413,409,414,432,348,423,443,445,446,446,461,455,457,461,398,475,487,498,501,492,436,505,503,525,516,540,523,545,537,473,484,483,571,572,568,587,595,578,600,592,528,617,617,622,624,636,567,575,568,638,654,659,588,682,677,688,608,685,683,709,697,633,722,722,648,721,737,663,741,756,678,766,760,766,768,787,708,797,797,723,812,805},
//	{74,86,85,94,101,95,156,92,162,182,172,194,201,199,196,210,221,142,236,231,242,162,239,237,263,251,187,257,273,278,207,296,289,291,227,302,322,324,325,325,341,347,349,341,289,282,372,376,366,380,390,385,393,405,327,414,406,407,415,441,357,432,446,454,377,467,470,461,411,402,446,491,496,493,503,501,437,475,527,532,457,499,545,543,550,560,556,492,570,585,507,577,595,522,596,620,602,619,627,628,626,562,646,642,577,655,671,606,597,653,686,682,701,709,692,714,706,642,712,735,657,727,667,723,746,764,773,765,764,771,715,763,782,787,778,741,763,742},
//	{80,81,90,96,99,96,129,177,98,176,191,113,183,123,211,212,208,227,235,218,240,232,168,241,251,266,272,275,271,269,293,297,291,302,306,233,315,322,316,322,334,263,341,351,278,370,360,366,365,375,308,378,318,407,400,406,420,411,361,433,423,445,452,462,378,463,470,472,484,476,476,482,500,423,500,512,521,527,531,453,523,543,548,549,551,550,553,577,571,582,586,596,518,588,606,601,538,620,613,628,627,563,652,645,647,660,588,658,684,668,681,689,683,689,704,702,638,727,727,653,743,746,737,755,761,683,767,779,767,785,708,797,790,792,728,806,816,827},
//	{77,80,81,90,94,92,153,171,172,168,188,123,114,160,202,129,214,215,209,222,232,171,164,245,243,263,8369,272,194,282,269,298,214,308,303,314,234,317,313,318,322,259,329,269,354,355,349,356,363,299,388,388,314,399,389,411,409,339,433,428,439,441,364,436,439,461,396,389,483,478,489,409,482,498,502,8614,518,439,516,514,540,528,464,534,474,559,549,571,569,572,582,580,514,602,604,594,601,608,558,549,605,638,576,569,661,651,649,673,594,667,683,609,703,698,709,629,702,718,644,722,732,659,748,741,739,763,684,756,759,782,773,740,714,776,803,814,734,810},
//	{70,70,76,85,85,86,157,83,172,172,98,168,108,199,187,201,196,212,220,151,232,225,231,245,236,186,258,248,270,277,287,203,288,295,297,309,301,301,307,325,257,253,345,335,347,273,358,365,367,379,371,371,377,396,318,403,393,415,413,416,426,424,358,446,448,438,445,452,388,458,481,403,473,413,501,492,510,519,511,510,517,465,458,552,547,558,478,563,553,575,573,503,574,602,518,603,593,622,611,621,619,553,642,635,637,650,592,583,634,662,682,673,684,686,706,635,628,666,715,708,738,732,736,663,716,755,751,760,757,705,698,742,785,778,791,799,740,733},
//	{67,80,81,84,86,88,131,165,169,179,173,175,199,115,185,207,199,135,209,233,215,232,240,241,239,258,180,264,260,195,251,270,275,266,234,225,276,304,324,315,326,328,348,273,354,347,353,367,358,308,380,370,392,399,409,325,410,417,419,431,423,423,429,447,379,375,453,468,390,460,476,481,489,502,493,503,501,435,529,524,535,463,545,548,539,557,489,485,574,574,500,588,594,597,589,590,607,535,626,618,618,624,639,648,570,654,666,654,672,595,684,677,679,615,693,703,714,704,722,723,719,739,660,730,748,743,680,774,769,780,700,785,775,804,720,809,802,804},
//	{77,85,94,95,101,97,166,94,183,183,109,197,203,206,198,199,216,144,216,233,237,248,238,252,263,198,202,207,212,217,222,227,232,237,242,247,252,257,262,267,272,277,282,287,292,297,302,307,312,317,322,327,332,337,342,347,352,357,362,367,372,377,382,387,392,397,402,407,412,417,422,427,432,437,442,447,452,457,462,467,472,477,482,487,492,497,502,507,512,517,522,527,532,537,542,547,552,557,562,567,572,577,582,587,592,597,602,607,612,617,622,627,632,637,642,647,652,657,662,667,672,677,682,687,692,697,702,707,712,717,722,727,732,737,742,747,752,757},
//};
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////// CASO 4 ///////////////////////////////////////////////////////////////////////////////////////////////
//#define nLines 51			//N�mero de filas de los textos cifrados
//#define nCharsPerLine 155	//N�mero de caracteres en cada fila de los textos cifrados
//#define nRotors 8			//N�mero de rotores de enigma para cifrar y descifrar
//int ciphered[nLines][nCharsPerLine] = { //[51][155] 8 rotores
//	{92,94,107,113,126,129,141,148,147,183,228,158,250,246,255,273,198,286,279,302,299,320,258,254,349,339,278,366,376,371,393,387,404,418,342,415,358,446,439,464,455,474,482,483,498,430,508,528,519,539,539,565,565,576,577,510,584,591,617,611,618,558,645,652,582,635,646,647,614,692,709,720,646,719,662,746,743,768,765,771,710,786,791,818,807,833,827,850,774,866,869,798,875,902,906,912,903,913,938,862,950,957,973,963,984,910,1001,1006,1003,1009,1034,1040,1051,1051,982,1060,1067,1071,1098,1107,1112,1107,1129,1054,1141,1140,1078,1123,1131,1141,1110,1201,1199,1205,1220,1215,1234,1249,1174,1265,1269,1198,1271,1297,1222,1314,1317,1246,1327,1339,1350,1360,1365,1380,1371},
//	{69,76,89,95,99,108,115,128,128,207,203,208,147,238,243,240,248,255,195,282,281,219,293,317,308,324,337,267,358,356,362,377,372,391,323,411,421,426,422,432,454,462,460,473,474,425,452,511,435,523,533,528,550,544,561,575,511,507,599,595,600,539,602,624,639,638,651,587,672,672,695,691,706,703,643,723,724,750,675,749,760,768,785,715,810,804,815,815,831,852,771,864,870,864,871,811,903,906,835,912,934,943,940,952,948,975,968,907,999,995,1000,939,1027,1034,1050,1040,1061,987,1078,1083,1080,1086,1111,1117,1128,1128,1073,1107,1154,1170,1160,1185,1176,1197,1135,1131,1223,1219,1224,1163,1255,1261,1252,1263,1276,1295,1292,1306,1313,1308,1327,1259,1322,1344,1359},
//	{83,91,100,102,113,120,133,136,139,201,214,150,235,235,258,254,269,266,206,298,287,305,307,329,254,327,270,354,365,378,302,389,388,326,418,415,427,427,366,443,465,470,467,473,487,487,506,514,535,454,532,549,560,486,578,574,579,518,602,599,624,621,627,566,642,647,674,663,689,683,706,644,679,724,654,748,743,747,773,694,781,780,718,810,806,815,833,770,766,861,851,790,863,874,882,891,898,838,930,926,931,870,923,934,935,902,983,996,1010,1013,942,1034,1030,1035,974,1066,1072,1063,1074,1087,1106,1103,1117,1124,1119,1138,1070,1133,1155,1170,1169,1182,1118,1203,1203,1226,1222,1237,1234,1174,1247,1268,1266,1206,1282,1291,1316,1307,1322,1333,1342,1339,1346,1286,1367},
//	{74,82,90,105,107,114,129,132,134,213,137,218,231,245,248,177,250,193,283,278,302,308,298,307,325,326,265,350,346,372,381,374,395,321,342,337,428,429,426,455,446,385,473,466,491,482,501,509,510,525,457,535,555,546,566,566,592,592,603,604,551,578,636,561,645,656,663,664,601,674,700,625,717,713,718,657,702,710,720,689,765,770,797,786,729,816,815,753,826,847,866,785,863,880,891,894,890,917,841,914,939,934,873,948,968,975,991,982,1003,1013,1006,1013,953,1034,1047,1061,1064,993,1085,1081,1086,1025,1117,1110,1137,1141,1065,1143,1154,1165,1166,1105,1192,1191,1129,1202,1145,1236,1241,1238,1244,1258,1263,1274,1278,1285,1225,1303,1320,1331,1334,1330,1357,1293,1289},
//	{78,90,94,98,106,120,124,132,135,214,210,215,154,242,249,265,255,276,202,293,298,295,301,326,332,343,343,274,352,359,363,390,399,404,399,421,346,421,427,448,378,452,463,402,479,506,510,516,507,517,542,535,542,482,571,583,579,581,597,606,627,546,620,651,570,662,658,667,685,610,698,691,716,707,726,734,735,750,682,760,780,771,791,791,817,817,828,829,776,811,856,786,878,874,879,818,906,916,921,930,937,949,943,950,890,978,971,996,987,1006,1014,1015,1030,962,1040,1060,1051,1071,1071,1097,1097,1108,1109,1054,1050,1142,1138,1143,1082,1127,1135,1145,1114,1205,1203,1209,1224,1219,1238,1253,1178,1268,1263,1269,1289,1300,1294,1303,1310,1250,1324,1355,1274,1347,1290},
//	{87,95,104,107,120,129,139,142,144,206,219,220,241,249,248,263,195,268,293,288,227,303,316,337,332,335,344,351,291,372,385,399,402,331,385,347,434,449,440,461,463,460,483,491,492,505,506,443,519,524,551,540,483,574,568,578,592,592,609,623,630,569,615,643,648,665,607,603,695,691,696,635,691,702,695,667,754,753,691,745,707,798,792,802,816,816,833,847,854,779,852,877,872,811,886,906,912,923,936,943,936,943,883,957,988,907,998,1002,1008,1008,947,1033,1042,1039,1048,1070,995,1076,1089,1019,1107,1100,1125,1116,1135,1143,1144,1159,1105,1151,1179,1184,1123,1213,1208,1230,1240,1239,1255,1262,1187,1260,1285,1280,1219,1294,1314,1319,1327,1328,1334,1359,1352,1359,1299},
//	{88,91,100,114,118,123,131,140,142,202,223,221,161,252,262,262,270,266,291,290,315,302,309,249,323,354,273,365,361,366,305,390,386,412,421,414,435,361,447,456,453,462,415,461,489,494,433,511,522,535,530,549,481,537,548,541,513,603,598,620,630,629,645,652,577,664,663,601,678,682,692,705,641,716,729,730,751,759,758,773,705,778,803,798,737,828,818,847,838,845,785,866,879,809,901,897,902,841,933,926,953,957,881,959,970,981,982,933,929,1024,1017,1026,1028,1041,977,1052,1058,1079,1009,1083,1094,1033,1123,1118,1122,1133,1073,1146,1167,1165,1105,1178,1199,1194,1213,1234,1243,1230,1237,1177,1251,1282,1201,1254,1290,1292,1315,1320,1332,1336,1335,1357,1281,1326,1385},
//	{87,92,101,113,114,124,128,137,141,203,213,228,174,220,248,257,275,200,278,298,289,309,309,335,335,346,347,280,355,361,382,312,386,397,336,417,429,440,444,445,461,461,478,492,485,492,432,518,527,540,464,551,558,564,585,504,591,598,528,620,616,621,560,635,652,669,675,684,677,698,707,632,706,733,740,664,737,756,771,775,704,791,798,728,820,816,821,760,836,845,867,867,884,887,896,824,899,919,925,936,949,956,949,970,910,945,990,920,1012,1008,1013,952,1029,1056,1056,1053,1074,1073,1085,1085,1102,1116,1052,1048,1143,1133,1072,1148,1157,1176,1180,1191,1209,1128,1220,1216,1225,1243,1168,1246,1266,1257,1277,1277,1303,1303,1314,1315,1248,1335,1342,1272,1345,1288,1364},
//	{80,86,93,101,118,121,130,140,138,202,224,224,241,244,253,181,256,276,282,293,306,313,306,327,253,348,342,361,357,293,366,309,337,325,346,341,416,436,447,442,381,430,475,489,482,497,429,472,493,506,475,510,561,485,577,580,588,592,525,612,619,625,646,565,638,581,659,666,692,613,698,702,715,730,737,730,752,677,769,772,701,778,805,809,815,806,816,841,765,857,853,858,797,885,892,908,898,919,845,936,941,938,944,969,975,986,986,917,995,1002,1006,1033,1042,1047,1042,1064,989,1067,1087,1092,1098,1029,1121,1117,1122,1061,1087,1091,1109,1114,1101,1148,1151,1125,1170,1178,1188,1157,1233,1238,1265,1254,1280,1274,1297,1233,1229,1320,1314,1339,1330,1347,1277,1369,1366},
//	{91,97,111,118,123,134,144,150,149,221,221,243,168,246,249,275,284,277,298,224,316,312,313,334,264,357,363,361,374,375,312,368,417,420,416,431,438,382,428,456,465,483,408,486,506,497,517,517,543,543,554,555,488,573,569,587,589,611,536,617,636,560,637,641,667,681,600,678,695,706,632,725,731,725,746,755,692,688,783,776,791,720,796,815,744,830,839,852,776,856,857,886,877,816,889,910,929,848,936,929,954,945,964,972,973,988,920,1008,1018,1023,1023,1042,1033,1053,1061,1065,1078,1079,1016,1093,1120,1120,1117,1138,1137,1141,1158,1155,1165,1104,1185,1198,1128,1203,1223,1230,1243,1252,1258,1269,1259,1284,1281,1294,1295,1232,1324,1320,1325,1264,1352,1345,1370,1361,1380},
//	{87,87,96,103,119,123,130,142,140,211,212,227,159,232,251,254,270,281,280,299,295,308,322,247,339,342,271,348,375,379,385,376,386,411,335,427,423,428,367,412,420,430,399,487,494,510,500,521,447,538,543,540,546,571,577,588,588,533,527,572,580,590,559,640,658,583,656,599,689,684,690,710,721,715,724,731,671,762,760,766,781,776,795,727,814,813,751,828,843,844,850,875,881,880,882,888,907,839,912,922,947,944,965,960,979,992,911,998,997,935,1027,1023,1028,967,1041,1065,1056,1072,1085,1027,1023,1118,1111,1120,1122,1135,1071,1152,1170,1095,1170,1190,1195,1203,1204,1210,1235,1228,1235,1175,1253,1273,1278,1284,1215,1307,1303,1308,1247,1338,1330,1336,1355,1367,1295},
//	{82,92,97,104,110,118,128,138,138,217,213,231,236,250,244,253,189,266,281,282,288,313,319,324,321,330,352,291,285,345,373,378,317,390,413,421,425,430,432,438,465,462,476,483,413,500,499,437,482,490,500,469,549,550,576,501,582,594,605,612,623,633,622,643,657,581,669,679,670,680,705,702,704,710,729,661,755,742,761,778,770,709,790,803,733,818,818,825,838,840,846,865,797,889,895,890,894,921,922,922,939,953,889,885,970,974,985,990,1009,998,1023,1038,969,965,1056,1061,1068,1079,1089,1096,1033,1029,1102,1123,1121,1061,1153,1149,1154,1093,1174,1187,1201,1194,1209,1217,1222,1228,1234,1251,1248,1258,1197,1275,1286,1290,1305,1305,1328,1265,1261,1356,1349,1358,1360},
//	{84,90,98,104,119,126,132,143,141,208,144,224,225,251,176,250,261,269,286,216,311,305,308,317,332,353,272,362,357,363,383,383,398,401,426,413,420,360,434,465,384,457,476,484,416,508,504,509,448,538,533,555,549,553,578,571,584,589,610,619,558,552,611,647,576,654,657,682,620,616,707,699,713,717,734,748,745,763,772,779,704,782,802,807,813,744,838,825,850,849,863,877,883,808,884,897,915,907,921,936,940,945,958,957,979,904,984,985,1014,1005,944,1017,1027,1040,1049,1053,1078,1069,1076,1016,1095,1111,1119,1116,1056,1146,1141,1163,1173,1172,1188,1195,1120,1201,1214,1144,1236,1232,1241,1259,1184,1262,1273,1277,1292,1292,1246,1240,1286,1335,1346,1272,1353,1366,1379},
//	{74,86,93,96,106,114,127,128,133,212,201,222,219,229,180,176,267,259,273,277,294,308,305,323,332,339,264,342,362,367,373,304,345,397,397,418,417,419,425,446,376,439,457,468,491,503,503,514,524,520,456,499,541,558,572,578,573,512,592,597,612,624,552,644,640,645,584,672,665,690,681,700,721,730,717,724,664,752,749,767,776,780,781,720,801,814,824,837,844,768,795,806,792,867,880,881,906,897,907,932,925,946,955,880,974,969,969,912,1003,1001,1007,1022,1017,1036,1051,976,1057,1070,1083,1092,1085,1089,1100,1040,1127,1126,1064,1157,1163,1161,1174,1175,1112,1204,1200,1205,1217,1234,1160,1247,1263,1262,1192,1270,1281,1294,1295,1301,1322,1331,1270,1264,1324,1352,1357},
//	{90,94,99,108,116,129,134,144,143,221,215,154,245,243,249,264,259,278,293,218,293,313,324,332,327,349,354,361,368,366,306,398,401,330,421,426,423,429,443,448,459,461,402,476,500,491,507,520,450,523,533,558,555,576,571,590,603,536,530,579,624,554,597,642,651,664,659,614,610,701,693,707,711,728,742,739,757,766,773,698,776,796,801,807,738,798,837,835,848,849,858,879,867,810,871,904,907,928,919,940,949,947,966,979,898,978,979,1008,999,938,1014,1023,1045,1043,1049,1064,1063,1070,1010,1083,1104,1034,1107,1135,1142,1145,1151,1147,1174,1171,1173,1114,1190,1203,1203,1222,1230,1235,1248,1249,1186,1277,1291,1293,1302,1295,1311,1256,1250,1310,1338,1343,1282,1373,1387},
//	{76,89,88,97,105,120,121,128,133,211,220,213,229,160,241,259,184,259,279,286,294,293,299,324,317,324,264,356,359,288,380,376,381,320,395,415,421,432,445,452,445,466,392,470,487,498,424,514,509,513,532,477,556,553,565,565,504,580,593,593,612,620,625,638,639,576,650,681,600,681,694,708,701,722,728,738,733,756,753,766,767,704,796,792,797,736,828,824,833,846,851,857,870,871,808,893,903,900,909,848,935,934,872,964,960,965,904,978,1002,993,1009,1022,952,1025,1051,976,1051,1071,1082,1090,1085,1107,1112,1119,1126,1124,1137,1150,1151,1088,1174,1189,1189,1186,1197,1218,1227,1152,1219,1185,9355,1206,1253,1214,1208,1268,1296,1301,1240,1330,1325,1347,1341,1345,1370},
//	{84,88,91,99,112,119,125,133,136,198,211,147,234,233,171,259,252,279,287,280,301,305,235,325,320,326,346,346,361,364,383,380,394,401,331,418,417,355,447,443,448,387,432,440,450,419,510,508,514,529,524,543,475,556,569,566,583,600,591,600,622,547,639,635,640,579,657,674,679,687,698,714,708,721,722,659,750,759,752,771,782,733,715,791,796,823,812,755,830,850,855,863,864,870,895,892,906,913,855,851,927,932,959,948,891,982,991,994,1005,996,1010,1016,967,963,1039,1044,1071,1060,1003,1091,1101,1106,1102,1112,1134,1142,1140,1153,1154,1103,1099,1175,1180,1207,1196,1139,1214,1231,1228,1254,1262,1260,1265,1276,1278,1284,1311,1308,1322,1329,1271,1267,1340,1361,1359},
//	{82,92,104,105,113,129,135,145,142,219,214,220,240,240,255,258,277,274,288,295,225,298,324,249,340,337,352,368,367,297,378,391,321,367,410,416,438,443,438,377,402,407,401,450,495,425,512,523,517,526,547,473,565,568,497,587,582,588,608,619,613,553,598,606,616,585,676,674,680,695,690,709,724,661,657,748,742,767,758,779,770,789,721,798,813,814,820,845,851,856,853,862,884,809,895,894,902,909,849,941,944,873,947,958,897,985,989,986,996,1006,1013,953,1040,1047,977,1069,1065,1070,1009,1100,1092,1098,1117,1129,1071,1065,1125,1163,1154,1165,1178,1197,1194,1208,1215,1210,1229,1161,1237,1246,1271,1266,1268,1278,1217,1310,1316,1326,1314,1333,1341,1362,1281,1361,1362},
//	{100,105,111,123,128,136,145,147,152,230,155,181,187,179,256,271,272,278,303,309,314,311,320,342,281,275,323,370,386,376,401,392,413,351,347,437,432,438,448,465,479,479,500,431,427,472,480,490,459,535,544,569,564,566,576,598,523,618,612,631,627,563,636,662,587,672,668,689,708,627,700,726,651,677,688,697,683,760,775,776,782,807,813,818,815,824,846,771,851,852,881,872,811,885,896,904,921,851,944,950,944,951,903,899,972,998,923,1014,1011,1026,1042,1041,971,1052,1065,995,1041,1084,1090,1112,1117,1112,1051,1077,1075,1140,1092,1105,1099,1159,1187,1192,1131,1212,1225,1222,1245,1240,1244,1270,1264,1203,1284,1297,1227,1319,1315,1320,1259,1345,1360,1360,1357,1368,1389},
//	{92,100,105,120,119,134,141,148,148,222,221,159,236,251,252,258,283,289,294,291,300,322,247,324,341,336,345,363,364,386,311,401,396,402,422,433,427,440,453,454,391,478,477,415,495,516,510,516,455,531,536,563,552,495,587,583,588,609,604,609,640,559,644,640,658,664,677,678,615,707,703,708,647,723,728,755,744,687,775,785,790,786,796,818,826,824,837,838,775,866,875,864,878,884,823,904,917,847,893,936,942,964,969,964,903,928,919,1004,1014,1025,1020,959,1040,1052,1063,1070,1081,1091,1080,1101,1115,1039,1112,1133,1131,1071,1146,1166,1172,1183,1187,1192,1194,1200,1227,1220,1227,1181,1175,1235,1263,1272,1290,1215,1301,1310,1323,1247,1334,1341,1347,1368,1287,1362,1382},
//	{85,96,108,110,123,132,132,146,145,218,231,241,241,241,263,188,261,204,288,299,312,236,323,322,260,335,355,361,372,385,392,385,406,332,422,417,439,443,457,462,455,465,487,412,486,513,520,444,517,536,551,555,484,568,569,573,584,607,532,624,627,556,644,651,659,670,596,672,677,704,693,636,713,740,744,750,741,751,776,773,787,794,724,816,812,817,838,833,838,869,788,864,877,894,889,895,920,920,941,860,933,946,954,961,967,992,989,1002,1003,940,1032,1028,1033,972,1045,1055,1063,1089,1094,1085,1095,1125,1044,1131,1130,1068,1143,1160,1157,1183,1191,1189,1194,1205,1207,1213,1240,1237,1251,1258,1202,1196,1256,1284,1289,1310,1305,1244,1317,1342,1337,1276,1361,1357,1378},
//	{87,98,101,112,120,131,134,149,145,229,148,239,237,243,258,253,272,204,292,302,307,303,313,335,343,341,354,355,292,377,377,400,396,411,408,431,356,451,444,453,455,468,404,479,485,506,436,510,521,460,553,559,553,560,500,592,595,524,601,628,632,638,629,639,664,588,633,641,651,620,698,705,709,736,745,750,745,767,692,787,781,800,796,732,811,827,835,832,772,848,861,879,871,894,893,905,909,922,917,944,941,955,962,906,900,960,988,993,1015,1009,948,1033,1033,1056,1052,1067,1064,1087,1012,1093,1106,1103,1120,1137,1128,1137,1076,1168,1165,1177,1177,1116,1192,1211,1217,1213,1229,1242,1172,1245,1266,1261,1280,1301,1303,1301,1319,1256,1252,1330,1350,1345,1365,1377,1369},
//	{77,85,93,100,116,124,125,131,136,209,206,236,155,231,250,256,252,268,281,211,284,305,300,319,340,342,340,358,295,291,364,385,383,323,415,412,424,424,376,441,461,456,476,488,480,497,494,524,443,516,537,532,551,572,574,572,590,529,523,564,539,614,634,640,651,644,669,660,687,684,705,696,635,708,729,724,743,764,766,764,782,707,794,793,731,807,820,825,833,840,861,856,873,887,811,884,907,915,925,930,924,934,947,952,974,899,991,994,923,1014,1019,1016,1022,1047,1053,1044,1063,995,1086,1084,1090,1105,1100,1119,1051,1141,1136,1155,1165,1160,1182,1176,1193,1207,1196,1223,1220,1234,1241,1171,1266,1252,1278,1203,1291,1288,1309,1305,1322,1333,1336,1336,1343,1283,1364},
//	{92,98,107,119,126,127,136,145,147,220,150,242,238,243,182,270,263,286,283,304,230,297,269,315,276,270,330,358,363,385,379,318,391,414,422,432,437,431,441,454,459,481,406,487,500,497,514,531,522,531,470,558,565,581,571,592,518,609,614,611,617,642,648,639,658,590,666,675,692,705,703,722,735,654,670,718,729,722,703,702,794,787,793,806,820,823,839,851,843,865,802,798,871,898,901,907,911,913,854,930,939,945,965,971,982,989,1001,999,1018,1015,1029,1036,1049,986,982,1074,1071,1083,1083,1035,1100,1120,1115,1135,1147,1139,1156,1153,1183,1102,1118,1202,1139,1204,1151,1150,1227,1244,1243,1264,1261,1287,1206,1282,1295,1313,1322,1328,1327,1328,1355,1362,1359,1373,1380},
//	{75,85,93,99,104,111,120,128,132,210,147,143,216,237,235,175,250,270,277,291,288,301,316,318,332,338,263,336,357,355,295,371,384,402,394,417,412,435,428,367,462,448,477,468,483,484,507,431,504,527,535,545,550,544,554,567,572,594,531,527,605,625,630,636,567,662,655,664,666,679,615,689,696,717,715,655,743,750,766,756,777,703,781,788,792,819,828,833,828,850,775,850,856,877,807,881,892,831,908,935,939,945,936,946,971,964,971,911,984,1005,1003,943,1036,1042,1036,1043,983,1064,1077,1007,1099,1095,1100,1039,1117,1137,1128,1148,1148,1174,1174,1185,1186,1119,1206,1205,1143,1228,1238,1251,1254,1265,1191,1272,1284,1280,1294,1300,1321,1336,1255,1271,1316,1320,1296},
//	{78,85,97,108,112,117,126,137,137,199,216,213,239,247,245,250,261,263,269,296,293,307,314,258,252,301,352,276,357,375,300,388,395,397,410,424,417,424,364,451,465,472,396,488,484,485,512,448,444,517,537,547,554,555,492,565,584,592,524,616,612,617,556,634,641,645,672,681,686,681,620,712,725,724,721,743,668,755,754,692,737,745,755,724,815,813,819,834,829,848,863,800,796,852,863,856,828,901,924,932,942,947,941,951,964,969,991,916,992,1001,1017,1027,1034,1047,1056,1062,1053,1080,1073,1012,1104,1107,1036,1110,1121,1060,1152,1148,1153,1092,1177,1187,1199,1208,1132,1207,1227,1234,1247,1245,1263,1272,1265,1282,1296,1232,1228,1318,1323,1318,1345,1351,1360,1296,1292},
//	{91,94,102,113,123,128,134,147,145,205,226,224,164,241,250,258,265,271,296,293,314,305,244,325,338,268,345,372,376,382,373,383,408,405,418,419,356,448,444,449,388,464,477,495,504,501,514,511,536,533,554,545,484,575,580,577,583,608,614,605,624,556,644,637,664,672,665,686,690,703,628,706,723,734,660,733,743,751,777,782,773,800,793,732,808,821,839,831,854,853,865,869,882,877,904,901,915,922,852,926,937,960,971,961,969,986,916,1000,1001,1010,1032,956,1029,1050,1048,988,1078,1077,1083,1092,1112,1036,1089,1093,1073,1141,1154,1152,1177,1167,1177,1184,1124,1169,1177,1187,1239,1178,1172,1213,1272,1196,1284,1294,1289,1311,1305,1322,1336,1272,1268,1353,1349,1370,1389},
//	{99,107,109,122,128,134,141,146,151,223,223,246,242,257,254,277,202,275,300,295,234,327,333,327,334,274,366,369,298,373,379,398,397,423,422,419,446,439,378,470,466,471,410,466,477,470,442,529,528,466,557,555,561,576,571,590,605,544,538,598,626,631,570,633,655,670,669,682,618,703,703,726,722,737,734,674,755,773,698,785,792,791,730,817,816,754,846,842,847,786,871,881,893,902,826,914,921,930,943,942,939,964,902,898,979,992,922,1017,1010,1019,1021,1034,970,1063,1069,1063,1084,1093,1018,1093,1099,1118,1117,1143,1142,1139,1166,1159,1098,1190,1186,1191,1130,1186,1197,1190,1162,1249,1248,1186,1278,1274,1279,1218,1263,1271,1281,1250,1341,1339,1345,1360,1355,1374,1306},
//	{105,115,116,131,134,140,155,162,159,227,240,170,226,275,278,274,289,296,226,313,324,250,303,331,358,358,355,364,306,383,400,416,411,428,433,440,447,447,464,478,416,410,470,498,503,442,520,543,544,541,566,563,577,584,514,573,597,611,626,643,576,653,651,657,672,667,686,632,713,703,718,717,730,666,747,765,690,783,789,783,790,730,811,824,754,810,859,862,858,873,880,810,883,904,902,842,930,945,935,950,949,962,898,979,997,922,1015,1021,1015,1022,962,1043,1056,986,1039,1067,1094,1094,1091,1100,1056,1050,1099,1144,1074,1149,1155,1181,1175,1114,1201,1200,1138,1229,1231,1227,1246,1254,1186,1259,1279,1289,1303,1304,1318,1242,1329,1328,1266,1342,1347,1374,1363,1318,1314},
//	{77,84,97,98,112,115,125,134,135,178,189,182,154,241,240,178,270,266,271,210,255,263,273,242,333,331,337,352,347,366,298,373,379,400,330,404,415,354,443,455,451,453,469,478,499,418,505,500,526,515,531,544,543,550,490,564,595,514,606,602,617,629,623,562,654,665,665,594,672,695,696,693,718,715,729,736,749,688,682,724,783,790,726,722,800,820,825,831,762,808,851,857,879,884,879,901,826,852,850,916,867,866,939,960,958,898,924,922,989,939,950,946,1041,1031,970,1045,1051,1072,1002,1093,1087,1095,1034,1126,1122,1123,1150,1086,1082,1177,1171,1190,1186,1122,1212,1203,1226,1227,1230,1170,1246,1255,1280,1271,1286,1297,1306,1311,1311,1328,1342,1349,1274,1355,1368},
//	{89,94,108,118,121,132,140,148,147,225,217,231,235,252,249,259,198,271,292,290,230,311,324,324,341,352,355,351,378,375,389,396,326,418,411,417,430,444,453,458,469,469,495,414,487,508,506,446,538,534,539,478,571,574,569,589,595,599,612,613,550,637,636,574,603,629,598,675,696,687,642,638,733,723,727,752,743,752,770,771,710,786,795,820,815,817,827,849,774,869,863,874,882,814,909,903,906,915,930,951,870,944,955,894,982,992,987,996,1003,1024,1032,1027,1034,988,982,1027,1035,1045,1014,1105,1103,1109,1124,1119,1138,1153,1078,1165,1164,1102,1182,1203,1203,1199,1220,1150,1223,1233,1258,1255,1276,1271,1290,1287,1291,1313,1238,1313,1319,1340,1270,1344,1355,1294,1369},
//	{78,90,92,102,112,123,127,136,137,211,216,224,225,231,256,249,256,196,270,301,220,312,308,313,335,329,268,344,353,378,373,375,385,407,346,340,403,425,364,439,445,466,396,471,491,496,504,505,511,536,460,552,548,553,492,567,593,598,606,601,618,632,556,651,651,662,663,669,682,683,620,707,718,644,728,729,733,758,762,765,778,779,716,807,816,805,832,841,847,772,859,858,796,887,891,897,897,836,927,932,929,935,949,954,965,967,908,996,993,1011,1020,1024,1025,964,980,1063,1073,1063,1076,1012,1085,1111,1036,1112,1134,1133,1154,1145,1166,1175,1100,1173,1194,1192,1132,1223,1232,1241,1232,1241,1258,1272,1279,1213,1212,1306,1301,1301,1244,1317,1338,1333,1352,1373,1375},
//	{88,91,98,115,115,127,135,145,143,211,229,154,241,240,178,270,266,271,283,300,226,271,279,289,258,349,347,353,368,363,382,397,322,389,362,358,354,387,431,392,386,435,472,410,505,495,434,509,515,534,533,559,558,555,582,575,514,606,602,607,546,602,613,606,578,659,672,602,694,690,695,634,687,715,742,742,739,748,690,777,788,714,770,819,822,818,833,840,770,847,864,880,875,892,897,904,911,911,928,942,878,874,955,974,898,993,987,998,1006,938,1030,1019,1037,1039,978,1051,994,1078,1089,1096,1097,1034,1126,1123,1135,1135,1074,1169,1162,1171,1173,1186,1122,1217,1207,1146,1221,1227,1248,1256,1265,1278,1202,1276,1287,1291,1316,1242,1323,1342,1280,1274,1334,1362,1367},
//	{93,94,102,110,124,125,138,146,145,222,217,226,243,254,249,200,196,291,281,220,298,315,311,337,343,268,355,362,292,372,387,403,324,416,419,348,423,429,448,447,473,472,469,496,489,428,520,516,521,460,516,527,520,492,579,578,516,561,569,579,548,639,637,643,658,653,672,687,612,686,717,636,724,717,742,733,752,760,761,776,708,781,804,812,822,827,821,831,844,849,871,810,804,860,885,910,901,920,928,929,944,876,949,972,980,990,995,989,999,1012,1017,1039,964,1039,1045,1066,996,1077,1089,1100,1110,1115,1130,1121,1060,1148,1158,1163,1159,1169,1191,1199,1197,1210,1211,1148,1239,1244,1241,1249,1256,1279,1204,1278,1305,1312,1236,1331,1325,1336,1344,1276,1362,1361,1369},
//	{71,78,93,95,102,111,117,130,130,193,133,225,218,224,237,251,260,265,276,276,286,290,312,237,329,325,326,353,277,368,378,381,389,396,407,417,341,417,430,448,457,463,462,463,490,497,490,497,437,512,532,538,549,562,569,558,585,582,596,603,616,555,549,603,644,660,646,657,662,694,696,633,629,721,717,722,743,738,677,750,775,770,709,801,812,812,741,816,836,842,850,860,867,873,894,813,889,902,907,915,922,943,938,955,969,893,971,991,982,1002,1002,1028,1028,1039,1040,1056,981,1059,1076,1087,1013,1087,1102,1108,1045,1121,1126,1153,1142,1085,1158,1179,1174,1193,1214,1216,1214,1232,1171,1165,1220,1259,1258,1197,1278,1296,1221,1262,1317,1310,1320,1333,1338,1277,1336},
//	{91,97,109,119,119,135,137,143,147,222,215,240,241,186,182,255,276,274,214,306,302,307,246,333,346,342,347,368,294,375,393,318,373,414,411,428,403,414,389,427,438,439,420,414,474,502,507,446,538,549,549,478,553,573,579,590,603,610,599,626,623,637,644,639,658,590,668,688,679,699,699,725,725,736,737,753,678,751,776,771,710,785,805,811,822,815,840,835,842,782,855,876,874,814,887,908,903,922,943,952,939,946,886,967,980,910,994,999,1018,1011,1032,1023,1050,1059,1064,1059,998,1065,1031,1038,1091,1052,1046,1087,1142,1135,1145,1158,1163,1102,1161,1198,1191,1216,1217,1150,1230,1231,1257,1182,1274,1270,1275,1214,1287,1298,1324,1311,1332,1346,1335,1349,1355,1294,1381},
//	{78,86,102,104,115,121,127,136,138,203,141,220,236,244,241,181,257,262,289,278,221,306,302,323,318,332,338,354,354,371,385,323,317,372,413,410,427,402,413,388,426,437,438,405,486,504,429,507,510,536,545,538,559,485,577,573,574,595,525,566,621,614,624,637,642,581,640,677,670,695,696,629,703,734,653,726,747,677,764,775,769,778,799,725,812,811,749,834,830,844,859,862,881,890,881,890,843,837,890,932,945,942,963,950,977,970,977,917,991,1022,941,1033,1029,1038,1056,981,1054,1075,1070,1089,1110,1112,1110,1128,1065,1061,1156,1146,1085,1173,1183,1178,1200,1194,1211,1225,1149,1222,1165,1253,1246,1271,1262,1281,1289,1290,1305,1237,1315,1335,1326,1346,1346,1372,1372},
//	{87,99,105,107,114,131,131,140,143,220,221,154,232,249,260,186,278,274,279,218,302,299,324,321,327,266,342,347,374,363,389,383,406,330,422,425,354,431,458,462,468,459,469,494,418,506,513,529,519,540,466,557,562,559,565,590,596,607,607,538,616,623,627,654,663,668,663,685,610,697,696,634,679,687,697,666,757,755,761,776,771,790,805,742,738,833,826,835,837,850,786,861,867,888,818,892,903,842,923,935,946,950,951,967,967,984,998,991,998,938,1019,1032,962,1014,1051,1064,1079,1090,1010,1083,1104,1102,1042,1095,1106,1107,1074,1151,1168,1184,1179,1196,1201,1208,1215,1215,1232,1246,1184,1178,1238,1266,1271,1210,1295,1291,1307,1320,1250,1325,1345,1352,1366,1372,1371},
//	{92,98,107,116,118,133,139,147,147,208,235,242,239,253,260,273,198,285,284,222,314,310,319,337,262,350,343,366,363,384,310,383,408,403,342,434,430,448,443,451,460,477,482,482,448,430,446,463,463,462,503,545,553,573,584,578,591,604,605,542,634,637,566,658,654,659,598,686,696,695,708,705,719,734,738,739,678,765,764,702,765,787,802,801,814,750,823,842,845,861,872,871,890,886,899,842,838,933,923,862,950,960,965,974,981,993,987,926,999,942,1030,1023,1048,1039,1058,1066,1067,1082,1014,1092,1112,1103,1123,1123,1149,1149,1160,1161,1094,1181,1180,1118,1181,1203,1218,1217,1230,1166,1239,1258,1261,1277,1288,1287,1306,1302,1315,1258,1254,1310,1308,1365,1355,1370,1369},
//	{99,115,123,124,139,146,149,163,159,226,174,170,262,265,194,269,289,295,306,319,326,319,258,314,325,318,290,377,376,314,359,367,377,360,354,414,442,447,386,459,484,477,490,499,518,511,517,542,551,556,551,490,577,576,514,570,568,625,615,630,629,642,578,659,677,602,676,683,709,703,710,650,737,744,674,766,762,767,706,791,787,813,822,815,836,775,853,854,851,880,871,810,895,905,902,911,864,858,918,946,951,890,935,943,953,922,1013,1011,1017,1032,1027,1046,1061,986,1076,1071,1077,1097,1108,1102,1111,1118,1058,1132,1163,1082,1159,1163,1173,1186,1122,1197,1210,1211,1232,1240,1239,1254,1186,1259,1284,1279,1218,1294,1307,1328,1323,1326,1335,1342,1282,1363,1376,1390,1393},
//	{96,100,107,121,126,135,138,145,149,190,152,239,254,245,266,268,265,288,296,297,310,311,248,324,329,356,345,288,379,373,383,397,397,414,428,435,374,368,428,456,461,478,420,416,508,504,509,448,502,464,555,549,559,573,573,590,604,611,536,609,634,629,568,643,663,669,680,693,700,693,700,640,714,745,664,756,752,757,696,781,777,803,812,805,826,752,825,846,844,784,875,876,873,902,893,832,918,927,924,933,872,953,966,896,984,977,1002,993,1012,1020,1021,1036,982,976,1036,1064,1069,1008,1098,1093,1115,1125,1124,1140,1147,1072,1145,1170,1165,1104,1179,1199,1204,1212,1213,1219,1244,1237,1244,1184,1257,1278,1276,1216,1307,1317,1317,1325,1321,1346,1345,1370,1357,1364,1304},
//	{93,105,117,122,133,132,147,155,153,214,245,164,256,252,257,196,281,277,303,312,305,326,252,338,347,344,353,306,300,360,388,393,332,410,421,434,429,448,380,443,465,480,479,492,428,484,495,488,460,550,545,567,577,576,592,599,524,611,610,548,625,629,639,652,588,663,676,677,698,706,705,720,652,725,750,745,684,775,765,794,785,792,732,813,826,756,848,844,849,788,880,873,900,904,828,906,917,928,929,880,876,971,964,973,975,988,924,999,1005,1026,956,1030,1041,980,1070,1065,1069,1080,1020,1093,1114,1112,1052,1125,1146,1141,1160,1181,1190,1177,1184,1124,1198,1229,1148,1201,1237,1239,1262,1267,1279,1283,1282,1304,1228,1273,1332,1319,1329,1344,1290,1284,1300,1318,1317},
//	{83,85,98,105,110,118,134,136,138,133,174,149,234,238,241,249,265,266,205,283,294,305,306,245,332,331,269,361,357,362,301,392,397,394,400,414,419,430,434,441,381,459,476,487,490,486,513,437,532,518,544,469,562,568,562,569,523,517,577,605,610,631,626,565,638,663,658,597,682,678,699,718,637,720,726,739,737,760,685,772,771,709,754,762,772,741,817,822,849,838,864,858,881,888,813,894,907,837,929,925,930,869,964,964,975,977,977,944,925,1001,1014,1019,1027,1034,1055,1050,1067,1081,1005,1081,1086,1113,1102,1128,1122,1145,1152,1077,1157,1158,1187,1178,1117,1193,1206,1211,1219,1226,1247,1242,1259,1273,1197,1275,1286,1297,1298,1237,1315,1332,1343,1346,1342,1369,1376},
//	{83,96,106,107,114,121,138,140,142,151,145,194,239,169,256,267,261,270,291,217,309,312,241,329,339,344,340,350,372,380,305,378,399,418,337,420,426,439,437,377,464,463,401,446,454,464,433,509,514,541,530,473,547,578,497,589,585,590,529,617,627,632,641,648,660,654,661,601,689,682,707,698,717,725,726,741,673,751,771,762,782,782,808,808,819,820,765,761,806,814,824,793,869,874,901,890,833,919,918,926,933,873,965,968,897,971,982,921,996,1016,1023,1039,1030,1051,1061,1054,1061,1001,1082,1095,1109,1112,1041,1126,1130,1133,1141,1157,1158,1097,1175,1186,1197,1198,1220,1159,1153,1213,1241,1246,1185,1275,1270,1285,1282,1309,1306,1320,1327,1340,1337,1346,1361,1289,1363},
//	{82,82,90,100,108,121,127,132,135,199,222,233,223,231,248,178,270,266,271,210,295,299,302,310,326,327,266,344,355,366,367,306,379,400,398,338,430,426,431,370,458,451,476,467,486,494,495,510,442,520,540,531,551,551,577,577,588,589,522,603,621,546,622,631,650,651,653,678,671,678,618,699,712,642,688,731,737,759,764,759,698,725,728,722,738,757,755,754,795,770,845,865,871,882,875,900,891,918,915,936,927,866,943,970,970,967,988,987,999,999,1016,1030,954,1049,1035,1061,986,1062,1071,1093,1091,1097,1112,1111,1118,1072,1107,1152,1082,1174,1170,1175,1114,1191,1218,1218,1215,1236,1235,1247,1247,1264,1278,1267,1286,1218,1309,1318,1307,1321,1327,1278,1274,1369,1359},
//	{89,102,106,110,127,134,136,146,147,212,223,240,249,258,182,272,283,284,214,306,302,307,246,324,347,348,345,370,367,381,388,318,406,421,411,426,425,438,374,455,468,398,490,486,491,430,483,511,538,538,535,544,486,563,580,596,591,608,613,620,627,627,644,658,582,674,677,606,683,710,714,720,711,721,746,670,726,737,730,702,780,787,791,818,827,832,827,849,774,852,872,877,883,814,906,902,907,846,891,899,909,878,969,967,973,988,983,1002,934,1007,1033,958,1031,974,1048,1055,1081,1075,1090,1095,1108,1107,1046,1124,1141,1152,1078,1153,1173,1179,1190,1183,1208,1207,1225,1229,1236,1166,1239,1260,1258,1198,1289,1299,1288,1313,1307,1327,1339,1331,1348,1362,1362,1383,1302},
//	{93,102,110,117,122,131,140,153,149,226,237,238,168,224,222,279,269,284,283,296,232,319,326,256,348,344,349,288,349,370,397,398,412,421,344,432,436,433,460,454,471,482,485,430,476,504,509,448,538,533,555,565,564,580,587,512,603,600,615,631,552,644,640,641,668,592,684,680,685,624,680,678,735,725,740,739,752,688,768,769,798,789,728,820,816,821,760,851,841,861,861,800,890,885,907,917,916,932,856,929,955,880,958,981,982,979,1004,1001,1015,1022,952,1040,1055,1045,1060,1059,1072,1022,1049,1094,1116,1109,1130,1056,1148,1144,1153,1171,1108,1104,1199,1189,1128,1218,1229,1230,1160,1252,1248,1253,1192,1248,1297,1300,1296,1311,1318,1248,1326,1349,1350,1347,1372,1369,1383},
//	{78,87,92,100,110,124,123,137,136,209,139,198,222,236,251,268,201,278,276,282,297,292,311,257,338,328,343,342,355,291,372,385,315,407,403,408,347,438,428,448,448,387,464,481,497,492,509,514,521,528,528,545,559,483,578,572,591,587,523,579,577,634,624,639,638,651,601,647,675,680,619,696,723,723,720,741,740,752,752,769,783,772,791,723,813,808,830,840,839,855,779,870,867,882,898,902,827,919,915,916,943,867,959,955,960,899,987,997,1002,1011,1018,1030,1024,1031,971,1059,1052,1077,1068,1087,1095,1096,1111,1043,1121,1141,1132,1152,1152,1178,1178,1189,1190,1123,1204,1222,1147,1178,1163,1255,1252,1264,1264,1286,1211,1289,1292,1318,1327,1320,1341,1267,1359,1355,1356},
//	{90,90,101,108,117,130,131,147,143,216,146,239,245,243,256,257,194,250,299,302,298,313,320,264,258,318,346,355,373,298,386,379,402,399,420,346,427,445,370,457,468,465,467,488,491,516,503,510,450,523,549,474,552,569,574,582,593,609,613,552,546,605,631,637,662,659,673,680,610,636,626,718,707,725,727,749,674,747,690,764,788,787,791,800,738,825,840,831,852,864,859,863,889,810,897,896,834,926,922,927,866,954,964,963,976,973,987,1002,1006,1007,946,1033,1032,970,1062,1058,1063,1002,1065,1087,1102,1101,1114,1050,1135,1135,1158,1154,1169,1166,1118,1114,1187,1208,1206,1146,1238,1234,1239,1256,1186,1274,1284,1279,1301,1295,1312,1326,1333,1258,1331,1274,1365,1359,1380},
//	{92,95,105,117,124,133,135,149,147,215,215,234,166,239,258,261,277,288,287,306,302,315,246,333,332,270,362,358,363,302,365,387,402,401,414,350,435,435,458,454,469,466,406,479,500,498,438,530,526,531,470,558,568,573,582,589,601,595,602,542,630,623,648,639,658,666,667,682,614,692,712,703,723,723,749,749,760,761,694,781,780,718,810,806,811,750,813,835,850,849,862,798,883,883,906,902,917,914,868,862,911,956,886,945,971,977,1002,999,1013,1020,950,977,978,974,1069,1059,998,1086,1096,1091,1113,1107,1124,1138,1062,1139,1166,1166,1163,1184,1183,1195,1195,1212,1226,1215,1234,1166,1256,1251,1273,1283,1282,1298,1305,1230,1303,1324,1322,1262,1335,1356,1351,1370,1391},
//	{78,89,98,99,108,118,124,137,136,214,212,230,169,163,207,252,270,262,288,294,302,300,314,321,251,324,345,343,283,358,378,385,382,399,416,422,420,434,441,454,379,452,477,472,411,499,509,504,526,520,537,551,544,551,491,572,585,515,574,600,606,631,628,642,649,579,607,609,616,624,632,640,648,656,664,672,680,688,696,704,712,720,728,736,744,752,760,768,776,784,792,800,808,816,824,832,840,848,856,864,872,880,888,896,904,912,920,928,936,944,952,960,968,976,984,992,1000,1008,1016,1024,1032,1040,1048,1056,1064,1072,1080,1088,1096,1104,1112,1120,1128,1136,1144,1152,1160,1168,1176,1184,1192,1200,1208,1216,1224,1232,1240,1248,1256,1264,1272,1280,1288,1296,1304},
//};
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


void printNumbersAsString(int lines[nLines][nCharsPerLine])
{
	for (int idx = 0; idx < nLines; idx++)
	{
		char line[nCharsPerLine + 1];
		for (int idx2 = 0; idx2 < nCharsPerLine; idx2++)
		{
			line[idx2] = lines[idx][idx2];
		}
		line[nCharsPerLine] = '\0';
		printf("%s\n", line);
	}
}

int* decipher(int line[], int key)
{
	int rawData[nCharsPerLine];

	for (int idx = 0; idx < nCharsPerLine; idx++)
	{
		rawData[idx] = line[idx];
	}

	int* rotorKeys = (int*)malloc(sizeof(int) * nRotors);
	int remainder = key;
	for (int idx = 0; idx < nRotors; idx++)
	{
		int divisor = pow(10, (nRotors - (1 + idx)));
		rotorKeys[idx] = (int)(remainder / divisor);
		remainder = (int)(remainder % divisor);
	}


	for (int rotorIdx = 0; rotorIdx < nRotors; rotorIdx++)
	{
		int displacement = rotorKeys[rotorIdx];
		for (int idx = 0; idx < nCharsPerLine; idx++)
		{
			rawData[idx] = rawData[idx] - displacement++;
		}
	}

	free(rotorKeys);
	return rawData;
}

void enigma()
{
	printf("ESTO ES LA ENTRADA: \n");
	printNumbersAsString(ciphered);
	printf("\n");
	printf("\n");

	printf("DESCIFRANDO...: \n");
	int deciphered[nLines][nCharsPerLine];
	for (int idx = 0; idx < nLines; idx++)
	{
		for (int lineKey = (int)pow(10, nRotors - 1); lineKey < (int)pow(10, nRotors); lineKey++)
		{
			int* p_deciphered = decipher(ciphered[idx], lineKey);

			char decipheredLine[nCharsPerLine];
			for (int idx = 0; idx < nCharsPerLine; idx++)
			{
				decipheredLine[idx] = p_deciphered[idx];
			}

			char stringKey[nRotors + 1];
			sprintf_s(stringKey, "%d", lineKey);
			if (!strncmp(stringKey, decipheredLine, nRotors))
			{
				for (int idx2 = 0; idx2 < nCharsPerLine; idx2++)
				{
					deciphered[idx][idx2] = decipheredLine[idx2];
				}
				printf("Descifrada linea %d con clave %d\n", idx, lineKey);
				break;
			}
		}
	}

	printf("\n");
	printf("ESTO ES LA SALIDA:\n");
	printNumbersAsString(deciphered);
	printf("\n");
	printf("\n");
}

int main(int argc, char* argv[])
{

	enigma();

	return 0;
}